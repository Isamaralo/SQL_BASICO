/* Crear por orden */

CREATE TABLE ESTADIO(ESTADIO_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, FECHA_CREACION DATE, NUMERO_ASIENTOS INT, PRIMARY KEY(ESTADIO_ID));
CREATE TABLE EQUIPO(EQUIPO_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, ESTADIO_ID INT, PRIMARY KEY(EQUIPO_ID), FOREIGN KEY (ESTADIO_ID) REFERENCES ESTADIO(ESTADIO_ID));
CREATE TABLE AFICION(AFICION_ID INT NOT NULL, NOMBRE_DE_GUERRA VARCHAR(50) NOT NULL, EQUIPO_ID INT, SEGUIDOR_ID INT, PRIMARY KEY(AFICION_ID), FOREIGN KEY(EQUIPO_ID) REFERENCES EQUIPO(EQUIPO_ID));
CREATE TABLE CANTICO(CANTICO_ID INT NOT NULL, NOMBRE VARCHAR(200) NOT NULL, AFICION_ID INT, PRIMARY KEY(CANTICO_ID), FOREIGN KEY(AFICION_ID) REFERENCES AFICION(AFICION_ID));
CREATE TABLE JUGADOR(JUGADOR_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, EQUIPO_ID INT, POSICION VARCHAR(50), NUMERO_CAMISETA INT, PRIMARY KEY(JUGADOR_ID), FOREIGN KEY(EQUIPO_ID) REFERENCES EQUIPO(EQUIPO_ID));
CREATE TABLE SEGUIDOR_PELIGROSO(SEGUIDOR_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, AFICION_ID INT, FECHA_NAC DATE, DNI INT NOT NULL, PRIMARY KEY(SEGUIDOR_ID), FOREIGN KEY(AFICION_ID) REFERENCES AFICION(AFICION_ID));


CREATE TABLE TIPO_DE_RECURSO(TIPORECURSO_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, PRIMARY KEY(TIPORECURSO_ID));
CREATE TABLE PROYECTO(PROYECTO_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, DESCRIPCION VARCHAR(200), PRESUPUESTO INT, HORAS_ESTIMADAS INT NOT NULL, PRIMARY KEY (PROYECTO_ID));
CREATE TABLE FASE(FASE_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, FECHA_INICIO DATE NOT NULL, FECHA_FIN DATE NOT NULL, ESTADO VARCHAR(20), PROYECTO_ID INT NOT NULL, PRIMARY KEY (FASE_ID), FOREIGN KEY(PROYECTO_ID) REFERENCES PROYECTO(PROYECTO_ID));
CREATE TABLE RECURSO1(RECURSO1_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, COSTE INT, TIPORECURSO_ID INT NOT NULL, FASE_ID INT NOT NULL, PRIMARY KEY (RECURSO1_ID), FOREIGN KEY(TIPORECURSO_ID) REFERENCES TIPO_DE_RECURSO(TIPORECURSO_ID), FOREIGN KEY(FASE_ID) REFERENCES FASE(FASE_ID));



/* LIGA CON INTEGRIDAD REFERENCIAL */
CREATE TABLE ESTADIO(ESTADIO_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, FECHA_CREACION DATE NOT NULL, NUMERO_ASIENTOS INT NOT NULL, PRIMARY KEY(ESTADIO_ID));
CREATE TABLE EQUIPO(EQUIPO_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, ESTADIO_ID INT NOT NULL, PRIMARY KEY(EQUIPO_ID), CONSTRAINT EQUIPO_FK FOREIGN KEY (ESTADIO_ID) REFERENCES ESTADIO(ESTADIO_ID) ON DELETE SET NULL);
CREATE TABLE AFICION(AFICION_ID INT NOT NULL, NOMBRE_DE_GUERRA VARCHAR(50) NOT NULL, EQUIPO_ID INT NOT NULL, PRIMARY KEY(AFICION_ID), CONSTRAINT AFICION_FK FOREIGN KEY(EQUIPO_ID) REFERENCES EQUIPO(EQUIPO_ID) ON DELETE CASCADE);
CREATE TABLE CANTICO(CANTICO_ID INT NOT NULL, NOMBRE VARCHAR(200) NOT NULL, AFICION_ID INT NOT NULL, PRIMARY KEY(CANTICO_ID), CONSTRAINT CANTICO_FK FOREIGN KEY(AFICION_ID) REFERENCES AFICION(AFICION_ID) ON DELETE CASCADE);
CREATE TABLE JUGADOR(JUGADOR_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, EQUIPO_ID INT, POSICION VARCHAR(50) NOT NULL, NUMERO_CAMISETA INT NOT NULL, PRIMARY KEY(JUGADOR_ID), CONSTRAINT JUGADOR_FK FOREIGN KEY(EQUIPO_ID) REFERENCES EQUIPO(EQUIPO_ID) ON DELETE SET NULL);
CREATE TABLE SEGUIDOR_PELIGROSO(SEGUIDOR_ID INT NOT NULL, NOMBRE VARCHAR(50) NOT NULL, AFICION_ID INT, FECHA_NAC DATE NOT NULL, DNI INT NOT NULL, PRIMARY KEY(SEGUIDOR_ID), CONSTRAINT SEGUIDOR_PELIGROSO_FK FOREIGN KEY(AFICION_ID) REFERENCES AFICION(AFICION_ID));

CREATE OR REPLACE FORCE VIEW "ISABEL"."SALARIOSALTOS" ("JUGADOR.NOMBRE", "EQUIPO.NOMBRE", "JUGADOR.SALARIO") AS SELECT J.NOMBRE, E.NOMBRE, SALARIO FROM JUGADOR J, EQUIPO E WHERE E.EQUIPO_ID=J.EQUIPO_ID AND SALARIO>2000 WITH READ ONLY;

/* TABLA HISTÓRICO SUBIDA SALARIOS EMPLOYEES */
CREATE TABLE INCREMENTOS_SALARIO (INCREMENTOS_ID INT NOT NULL, EMPLOYEE_ID INT NOT NULL, SALARIO_ANTERIOR INT NOT NULL, SALARIO_POSTERIOR INT NOT NULL, FECHA DATE NOT NULL, PRIMARY KEY(INCREMENTOS_ID), FOREIGN KEY(EMPLOYEE_ID) REFERENCES EMPLOYEES(EMPLOYEE_ID));